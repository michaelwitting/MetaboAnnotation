<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Matches between query and target generic objects can be represented by
the Matched object. By default, all data accessors work as
left joins between the query and the target object, i.e. values are
returned for each query object with eventual duplicated entries (values)
if the query object matches more than one target object. See also
Creation and subsetting as well as Extracting data sections below for
details and more information.
The Matched object allows to represent matches between one-dimensional
query and target objects (being e.g. numeric or list),
two-dimensional objects (data.frame or matrix) or more complex
structures such as SummarizedExperiments or QFeatures. Combinations of
all these different data types are also supported. Matches are represented
between elements of one-dimensional objects, or rows for two-dimensional
objects (including SummarizedExperiment or QFeatures). For QFeatures()
objects matches to only one of the assays within the object is supported."><title>Representation of generic objects matches — addMatches • MetaboAnnotation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Representation of generic objects matches — addMatches"><meta property="og:description" content="Matches between query and target generic objects can be represented by
the Matched object. By default, all data accessors work as
left joins between the query and the target object, i.e. values are
returned for each query object with eventual duplicated entries (values)
if the query object matches more than one target object. See also
Creation and subsetting as well as Extracting data sections below for
details and more information.
The Matched object allows to represent matches between one-dimensional
query and target objects (being e.g. numeric or list),
two-dimensional objects (data.frame or matrix) or more complex
structures such as SummarizedExperiments or QFeatures. Combinations of
all these different data types are also supported. Matches are represented
between elements of one-dimensional objects, or rows for two-dimensional
objects (including SummarizedExperiment or QFeatures). For QFeatures()
objects matches to only one of the assays within the object is supported."><meta property="og:image" content="https://rformassspectrometry.github.io/MetaboAnnotation/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetaboAnnotation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MetaboAnnotation.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MetaboAnnotation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Representation of generic objects matches</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/HEAD/R/Matched.R" class="external-link"><code>R/Matched.R</code></a></small>
      <div class="d-none name"><code>Matched.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Matches between <em>query</em> and <em>target</em> generic objects can be represented by
the <code>Matched</code> object. By default, all data accessors work as
<em>left joins</em> between the <em>query</em> and the <em>target</em> object, i.e. values are
returned for each <em>query</em> object with eventual duplicated entries (values)
if the <em>query</em> object matches more than one <em>target</em> object. See also
<em>Creation and subsetting</em> as well as <em>Extracting data</em> sections below for
details and more information.</p>
<p>The <code>Matched</code> object allows to represent matches between one-dimensional
<code>query</code> and <code>target</code> objects (being e.g. <code>numeric</code> or <code>list</code>),
two-dimensional objects (<code>data.frame</code> or <code>matrix</code>) or more complex
structures such as <code>SummarizedExperiments</code> or <code>QFeatures</code>. Combinations of
all these different data types are also supported. Matches are represented
between elements of one-dimensional objects, or rows for two-dimensional
objects (including <code>SummarizedExperiment</code> or <code>QFeatures</code>). For <code>QFeatures()</code>
objects matches to only one of the <em>assays</em> within the object is supported.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>addMatches(object, ...)

filterMatches(object, param, ...)

matchedData(object, ...)

endoapply(object, ...)

Matched(
  query = list(),
  target = list(),
  matches = data.frame(query_idx = integer(), target_idx = integer(), score =
    numeric()),
  queryAssay = character(),
  targetAssay = character(),
  metadata = list()
)

# S4 method for Matched
length(x)

# S4 method for Matched
show(object)

# S4 method for Matched,ANY,ANY,ANY
[(x, i, j, ..., drop = FALSE)

matches(object)

target(object)

query(object)

whichTarget(object)

whichQuery(object)

# S4 method for Matched
$(x, name)

# S4 method for Matched
colnames(x)

# S4 method for Matched
matchedData(object, columns = colnames(object), ...)

pruneTarget(object)

# S4 method for Matched,missing
filterMatches(
  object,
  queryValue = integer(),
  targetValue = integer(),
  queryColname = character(),
  targetColname = character(),
  index = integer(),
  keep = TRUE,
  ...
)

SelectMatchesParam(
  queryValue = numeric(),
  targetValue = numeric(),
  queryColname = character(),
  targetColname = character(),
  index = integer(),
  keep = TRUE
)

TopRankedMatchesParam(n = 1L, decreasing = FALSE)

# S4 method for Matched,SelectMatchesParam
filterMatches(object, param, ...)

# S4 method for Matched,TopRankedMatchesParam
filterMatches(object, param, ...)

# S4 method for Matched
addMatches(
  object,
  queryValue = integer(),
  targetValue = integer(),
  queryColname = character(),
  targetColname = character(),
  score = rep(NA_real_, length(queryValue)),
  isIndex = FALSE
)

# S4 method for ANY
endoapply(object, FUN, ...)

# S4 method for Matched
endoapply(object, FUN, ...)

# S4 method for Matched
lapply(X, FUN, ...)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>a <code>Matched</code> object.</p></dd>


<dt>...</dt>
<dd><p>additional parameters.</p></dd>


<dt>param</dt>
<dd><p>for <code>filterMatches</code>: parameter object to select and customize
the filtering procedure.</p></dd>


<dt>query</dt>
<dd><p>object with the query elements.</p></dd>


<dt>target</dt>
<dd><p>object with the elements against which <code>query</code> has been
matched.</p></dd>


<dt>matches</dt>
<dd><p><code>data.frame</code> with columns <code>"query_idx"</code> (<code>integer</code>),
<code>"target_idx"</code> (<code>integer</code>) and <code>"score"</code> (<code>numeric</code>) representing the n:m
mapping of elements between the <code>query</code> and the <code>target</code> objects.</p></dd>


<dt>queryAssay</dt>
<dd><p><code>character</code> that needs to be specified when <code>query</code> is
a <code>QFeatures</code>. In this case, <code>queryAssay</code> is expected to be the name of
one of the assays in <code>query</code> (the one on which the matching was performed).</p></dd>


<dt>targetAssay</dt>
<dd><p><code>character</code> that needs to be specified when <code>target</code> is
a <code>QFeatures</code>. In this case, <code>targetAssay</code> is expected to be the name of
one of the assays in <code>target</code> (the one on which the matching was
performed).</p></dd>


<dt>metadata</dt>
<dd><p><code>list</code> with optional additional metadata.</p></dd>


<dt>x</dt>
<dd><p><code>Matched</code> object.</p></dd>


<dt>i</dt>
<dd><p><code>integer</code> or <code>logical</code> defining the <code>query</code> elements to keep.</p></dd>


<dt>j</dt>
<dd><p>for <code>[</code>: ignored.</p></dd>


<dt>drop</dt>
<dd><p>for <code>[</code>: ignored.</p></dd>


<dt>name</dt>
<dd><p>for <code>$</code>: the name of the column (or variable) to extract.</p></dd>


<dt>columns</dt>
<dd><p>for <code>matchedData</code>: <code>character</code> vector with column names of
variables that should be extracted.</p></dd>


<dt>queryValue</dt>
<dd><p>for <code>SelectMatchesParam</code>: vector of values to search for in
<code>query</code> (if <code>query</code> is 1-dimensional) or in column <code>queryColname</code> of
<code>query</code> (if <code>query</code> is 2-dimensional). For <code>addMatches</code>: either an index
in <code>query</code> or value in column <code>queryColname</code> of <code>query</code> defining (together
with <code>targetValue</code>) the pair of query and target elements for which a
match should be manually added. Lengths of <code>queryValue</code> and
<code>targetValue</code> have to match.</p></dd>


<dt>targetValue</dt>
<dd><p>for <code>SelectMatchesParam</code>: vector of values to search for
in <code>target</code> (if <code>target</code> is 1-dimensional) or in column <code>targetColname</code> of
<code>target</code> (if <code>target</code> is 2-dimensional). For <code>addMatches</code>: either an
index in <code>target</code> or value in column <code>targetColname</code> of <code>target</code> defining
(together with <code>queryValue</code>) the pair of query and target elements for
which a match should be manually added. Lengths of <code>queryValue</code> and
<code>targetValue</code> have to match.</p></dd>


<dt>queryColname</dt>
<dd><p>for <code>SelectMatchesParam</code>: if <code>query</code> is 2-dimensional it
represents the column of <code>query</code> against which elements of <code>queryValue</code>
are compared.</p></dd>


<dt>targetColname</dt>
<dd><p>for <code>SelectMatchesParam</code>: if <code>query</code> is 2-dimensional it
represents the column of <code>target</code> against which elements of <code>targetValue</code>
are compared.</p></dd>


<dt>index</dt>
<dd><p>for <code>SelectMatchesParam</code>: indices of the matches to keep (if
<code>keep = TRUE</code>) or to drop if (<code>keep = FALSE</code>).</p></dd>


<dt>keep</dt>
<dd><p>for <code>SelectMatchesParam</code>: <code>logical</code>. If <code>keep = TRUE</code> the matches
are kept, if <code>keep = FALSE</code> they are removed.</p></dd>


<dt>n</dt>
<dd><p>for <code>TopRankedMatchesParam</code>: <code>integer(1)</code> with number of best
ranked matches to keep for each <code>query</code> element.</p></dd>


<dt>decreasing</dt>
<dd><p>for <code>TopRankedMatchesParam</code>: <code>logical(1)</code> whether scores
should be ordered increasing or decreasing. Defaults to
<code>decreasing = FALSE</code>.</p></dd>


<dt>score</dt>
<dd><p>for <code>addMatches</code>: <code>numeric</code> (same length than <code>queryValue</code>) or
<code>data.frame</code> (same number of rows than <code>queryValue</code>) specifying the scores
for the matches to add. If not specified, a <code>NA</code> will be used as score.</p></dd>


<dt>isIndex</dt>
<dd><p>for <code>addMatches</code>: specifies if <code>queryValue</code> and
<code>targetValue</code> are expected to be vectors of indices.</p></dd>


<dt>FUN</dt>
<dd><p>for <code>lapply</code> and <code>endoapply</code>: user defined <code>function</code> that takes a
<code>Matched</code> object as a first parameter and possibly additional parameters
(that need to be provided in the <code>lapply</code> or <code>endoapply</code> call. For lapply
<code>FUN</code> can return any object while for <code>endoapply</code> it must return a
<code>Matched</code> object.</p></dd>


<dt>X</dt>
<dd><p><code>Matched</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>See individual method description above for details.</p>
    </div>
    <div class="section level2">
    <h2 id="creation-and-subsetting">Creation and subsetting<a class="anchor" aria-label="anchor" href="#creation-and-subsetting"></a></h2>
    


<p><code>Matched</code> object is returned as result from the <code><a href="matchValues.html">matchValues()</a></code> function.</p>
<p>Alternatively, <code>Matched</code> objects can also be created with the <code>Matched</code>
function providing the <code>query</code> and <code>target</code> objects as well as the <code>matches</code>
<code>data.frame</code> with two columns of integer indices defining which elements
from <em>query</em> match which element from <em>target</em>.</p><ul><li><p><code>[</code>: subset the object selecting <code>query</code> object elements to keep with
parameter <code>i</code>. The resulting object will contain all the matches
for the selected query elements. The <code>target</code> object will by default be
returned as-is.</p></li>
<li><p><code>addMatches</code>: add new matches to an existing object. Parameters
<code>queryValue</code> and <code>targetValue</code> allow to define which element(s) in
<code>query</code> and <code>target</code> should be considered matching. If <code>isIndex = TRUE</code>,
both <code>queryValue</code> and <code>targetValue</code> are considered to be integer indices
identifying the matching elements in <code>query</code> and <code>target</code>, respectively.
Alternatively (with <code>isIndex = FALSE</code>) <code>queryValue</code> and <code>targetValue</code> can
be elements in columns <code>queryColname</code> or <code>targetColname</code> which can be used
to identify the matching elements. Note that in this case
<strong>only the first</strong> matching pair is added. Parameter <code>score</code> allows to
provide the score for the match. It can be a numeric with the score or a
<code>data.frame</code> with additional information on the manually added matches. In
both cases its length (or number of rows) has to match the length of
<code>queryValue</code>. See examples below for more information.</p></li>
<li><p><code>endoapply</code>: applies a user defined function <code>FUN</code> to each subset of
matches in a <code>Matched</code> object corresponding to a <code>query</code> element. The
results are then combined in a single <code>Matched</code> object representing updated
matches. Note that <code>FUN</code> has to return a <code>Matched</code> object.</p></li>
<li><p><code>filterMatches</code>: filter matches in a <code>Matched</code> object using different
approaches depending on the class of <code>param</code>:</p><ul><li><p><code>SelectMatchesParam</code>: keeps or removes (respectively when parameter
<code>keep = TRUE</code> and <code>keep = FALSE</code>) matches corresponding to certain
indices or values of <code>query</code> and <code>target</code>. If <code>queryValue</code> and
<code>targetValue</code> are provided, matches for these value pairs are kept or
removed. Parameter index<code>allows to filter matches providing their index in the [matches()] matrix. Note that</code>filterMatches<code>removes only matches from the [matches()] matrix from the</code>Matched<code>object but thus not alter the</code>query<code>or</code>target` in the object. See examples below for more
information.</p></li>
<li><p><code>TopRankedMatchesParam</code>: for each query element the matches are ranked
according to their score and only the <code>n</code> best of them are kept (if <code>n</code>
is larger than the number of matches for a given query element all the
matches are returned). For the ranking (ordering) R's <code>rank</code> function is
used on the absolute values of the scores (variable <code>"score"</code>), thus,
smaller score values (representing e.g. smaller differences between
expected and observed m/z values) are considered <em>better</em>. By
setting parameter <code>decreasing = TRUE</code> matches can be ranked in decreasing
order (i.e. higher scores are ranked higher and are thus selected).
If besides variable <code>"score"</code> also variable <code>"score_rt"</code> is available in
the <code>Matched</code> object (which is the case for the <code>Matched</code> object
returned by <code><a href="matchValues.html">matchValues()</a></code> for <code>param</code> objects involving a retention
time comparison), the ordering of the matches is based on the product of
the ranks of the two variables (ranking of retention time differences
is performed on the absolute value of <code>"score_rt"</code>). Thus, matches with
small (or, depending on parameter <code>decreasing</code>, large) values for
<code>"score"</code> <strong>and</strong> <code>"score_rt"</code> are returned.</p></li>
</ul></li>
<li><p><code>lapply</code>: applies a user defined function <code>FUN</code> to each subset of
matches in a <code>Matched</code> object for each <code>query</code> element. It returns a
<code>list</code> of <code>length(object)</code> elements where each element is the output of
<code>FUN</code> applied to each subset of matches.</p></li>
<li><p><code>pruneTarget</code>: <em>cleans</em> the object by removing non-matched
<strong>target</strong> elements.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="extracting-data">Extracting data<a class="anchor" aria-label="anchor" href="#extracting-data"></a></h2>
    

<ul><li><p><code>$</code> extracts a single variable from the <code>Matched</code> <code>x</code>. The variables that
can be extracted can be listed using <code>colnames(x)</code>. These variables can
belong to <em>query</em>, <em>target</em> or be related to the matches (e.g. the
score of each match). If the <em>query</em> (<em>target</em>) object is two dimensional,
its columns can be extracted (prefix<code> "target_"</code> is used for columns in the
<em>target</em> object) otherwise if <em>query</em> (<em>target</em>) has only a single
dimension (e.g. is a <code>list</code> or a <code>character</code>) the whole object can be
extracted with <code>x$query</code> (<code>x$target</code>). More precisely, when
<em>query</em> (<em>target</em>) is a <code>SummarizedExperiment</code> the columns from
<code>rowData(query)</code> (rowData(<code>target</code>)) are extracted; when <em>query</em> (<em>target</em>)
is a <code>QFeatures()</code> the columns from <code>rowData</code> of the assay specified in the
<code>queryAssay</code> (<code>targetAssay</code>) slot are extracted. The matching scores
are available as <em>variable</em> <code>"score"</code>. Similar to a left join between the
query and target elements, this function returns a value for each query
element, with eventual duplicated values for query elements matching more
than one target element. If variables from the target <code>data.frame</code> are
extracted, an <code>NA</code> is reported for the entries corresponding to <em>query</em>
elements that don't match any target element. See examples below for
more details.</p></li>
<li><p><code>length</code> returns the number of <strong>query</strong> elements.</p></li>
<li><p><code>matchedData</code> allows to extract multiple variables contained in the
<code>Matched</code> object as a <code>DataFrame</code>. Parameter <code>columns</code> allows to
define which columns (or variables) should be returned (defaults to
<code>columns = colnames(object)</code>). Each single column in the returned
<code>DataFrame</code> is constructed in the same way as in <code>$</code>. That is, like <code>$</code>,
this function performs a <em>left join</em> of variables from the <em>query</em> and
<em>target</em> objects returning all values for all <em>query</em> elements
(eventually returning duplicated elements for query elements matching
multiple target elements) and the values for the target elements matched
to the respective query elements (or <code>NA</code> if the target element is not
matched to any query element).</p></li>
<li><p><code>matches</code> returns a <code>data.frame</code> with the actual matching information with
columns <code>"query_idx"</code> (index of the element in <code>query</code>), <code>"target_idx"</code>
(index of the element in <code>target</code>) <code>"score"</code> (the score of the match) and
eventual additional columns.</p></li>
<li><p><code>target</code> returns the <em>target</em> object.</p></li>
<li><p><code>query</code> returns the <em>query</em> object.</p></li>
<li><p><code>whichTarget</code> returns an <code>integer</code> with the indices of the elements in
<em>target</em> that match at least one element in <em>query</em>.</p></li>
<li><p><code>whichQuery</code> returns an <code>integer</code> with the indices of the elements in
<em>query</em> that match at least one element in <em>target</em>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MatchedSpectra.html">MatchedSpectra()</a></code> for matched <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> objects.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Andrea Vicini, Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Creating a `Matched` object.</span></span>
<span class="r-in"><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, col2 <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">16</span>, col2 <span class="op">=</span> <span class="fl">17</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Define matches between query row 1 with target row 2 and, query row 2</span></span>
<span class="r-in"><span class="co">## with target rows 2,3,4 and query row 5 with target row 5.</span></span>
<span class="r-in"><span class="va">mo</span> <span class="op">&lt;-</span> <span class="fu">Matched</span><span class="op">(</span></span>
<span class="r-in">    <span class="va">q1</span>, <span class="va">t1</span>, matches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>query_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span class="r-in">                                 target_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">4L</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span class="r-in">                                 score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mo</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 5 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 6 (4 matched)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which of the query elements (rows) match at least one target</span></span>
<span class="r-in"><span class="co">## element (row)?</span></span>
<span class="r-in"><span class="fu">whichQuery</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which target elements (rows) match at least one query element (row)?</span></span>
<span class="r-in"><span class="fu">whichTarget</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3 4 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting variable "col1" from query object .</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## We have duplicated values for the entries of `col1` related to query</span></span>
<span class="r-in"><span class="co">## elements (rows) matched to multiple rows of the target object). The</span></span>
<span class="r-in"><span class="co">## value of `col1` is returned for each element (row) in the query.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting variable "col1" from target object. To access columns from</span></span>
<span class="r-in"><span class="co">## target we have to prefix the name of the column by `"target_"`.</span></span>
<span class="r-in"><span class="co">## Note that only values of `col1` for rows matching at least one query</span></span>
<span class="r-in"><span class="co">## row are returned and an NA is reported for query rows without matching</span></span>
<span class="r-in"><span class="co">## target rows.</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">target_col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The 3rd and 4th query rows do not match any target row, thus `NA` is</span></span>
<span class="r-in"><span class="co">## returned.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## `matchedData` can be used to extract all (or selected) columns</span></span>
<span class="r-in"><span class="co">## from the object. Same as with `$`, a left join between the columns</span></span>
<span class="r-in"><span class="co">## from the query and the target is performed. Below we extract selected</span></span>
<span class="r-in"><span class="co">## columns from the object as a DataFrame.</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchedData</span><span class="op">(</span><span class="va">mo</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span>, <span class="st">"target_col1"</span>,</span>
<span class="r-in">                                   <span class="st">"target_col2"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          col1      col2 target_col1 target_col2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;integer&gt;   &lt;integer&gt;   &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1         6          12          18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2         7          12          18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1         2         7          13          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2         2         7          14          20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3         8          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4         9          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5        10          15          21</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">target_col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The example matched object contains all query and all target</span></span>
<span class="r-in"><span class="co">## elements (rows). Below we subset the object keeping only query rows that</span></span>
<span class="r-in"><span class="co">## are matched to at least one target row.</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="va">mo</span><span class="op">[</span><span class="fu">whichQuery</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mo_sub contains now only 3 query rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## while the original object contains all 5 query rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Both objects contain however still the full target object:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## With the `pruneTarget` we can however reduce also the target rows to</span></span>
<span class="r-in"><span class="co">## only those that match at least one query row</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">pruneTarget</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">########</span></span>
<span class="r-in"><span class="co">## Creating a `Matched` object with a `data.frame` for `query` and a `vector`</span></span>
<span class="r-in"><span class="co">## for `target`. The matches are specified in the same way as the example</span></span>
<span class="r-in"><span class="co">## before.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, col2 <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fl">11</span><span class="op">:</span><span class="fl">16</span></span>
<span class="r-in"><span class="va">mo</span> <span class="op">&lt;-</span> <span class="fu">Matched</span><span class="op">(</span><span class="va">q1</span>, <span class="va">t2</span>, matches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>query_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span class="r-in">    target_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">4L</span>, <span class="fl">5L</span><span class="op">)</span>, score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## *target* is a simple vector and has thus no columns. The matched values</span></span>
<span class="r-in"><span class="co">## from target, if it does not have dimensions and hence column names, can</span></span>
<span class="r-in"><span class="co">## be retrieved with `$target`</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">target</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note that in this case "target" is returned by the function `colnames`</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "col1"   "col2"   "target" "score" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## As before, we can extract all data as a `DataFrame`</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchedData</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2         7     12       0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1         2         7     13       0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2         2         7     14       0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note that the columns of the obtained `DataFrame` are the same as the</span></span>
<span class="r-in"><span class="co">## corresponding vectors obtained with `$`</span></span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">target</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Also subsetting and pruning works in the same way as the example above.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="va">mo</span><span class="op">[</span><span class="fu">whichQuery</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mo_sub contains now only 3 query rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## while the original object contains all 5 query rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Both object contain however still the full target object:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Reducing the target elements to only those that match at least one query</span></span>
<span class="r-in"><span class="co">## row</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">pruneTarget</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">########</span></span>
<span class="r-in"><span class="co">## Filtering `Matched` with `filterMatches`</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Inspecting the matches in `mo`:</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">target</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## We have thus target *12* matched to both query elements with values 1 and</span></span>
<span class="r-in"><span class="co">## 2, and query element 2 is matching 3 target elements. Let's assume we want</span></span>
<span class="r-in"><span class="co">## to resolve this multiple mappings to keep from them only the match between</span></span>
<span class="r-in"><span class="co">## query 1 (column `"col1"` containing value `1`) with target 1 (value `12`)</span></span>
<span class="r-in"><span class="co">## and query 2 (column `"col1"` containing value `2`) with target 2 (value</span></span>
<span class="r-in"><span class="co">## `13`). In addition we also want to keep query element 5 (value `5` in</span></span>
<span class="r-in"><span class="co">## column `"col1"`) with the target with value `15`:</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">filterMatches</span><span class="op">(</span><span class="va">mo</span>,</span>
<span class="r-in">    <span class="fu">SelectMatchesParam</span><span class="op">(</span>queryValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, queryColname <span class="op">=</span> <span class="st">"col1"</span>,</span>
<span class="r-in">                       targetValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 5 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7     13       0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Alternatively to specifying the matches to filter with `queryValue` and</span></span>
<span class="r-in"><span class="co">## `targetValue` it is also possible to specify directly the index of the</span></span>
<span class="r-in"><span class="co">## match(es) in the `matches` `data.frame`:</span></span>
<span class="r-in"><span class="fu">matches</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   query_idx target_idx score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1          2   0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2          2   0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         2          3   0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         2          4   0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5          5   0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## To keep only matches like in the example above we could use:</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">filterMatches</span><span class="op">(</span><span class="va">mo</span>, <span class="fu">SelectMatchesParam</span><span class="op">(</span>index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 5 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7     13       0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note also that, instead of keeping the specified matches, it would be</span></span>
<span class="r-in"><span class="co">## possible to remove them by setting `keep = FALSE`. Below we remove</span></span>
<span class="r-in"><span class="co">## selected matches from the object:</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">filterMatches</span><span class="op">(</span><span class="va">mo</span>,</span>
<span class="r-in">    <span class="fu">SelectMatchesParam</span><span class="op">(</span>queryValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, queryColname <span class="op">=</span> <span class="st">"col1"</span>,</span>
<span class="r-in">                       targetValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, keep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mo_sub</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3 4 5</span>
<span class="r-in"><span class="va">mo_sub</span><span class="op">$</span><span class="va">target</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 13 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## As alternative to *manually* selecting matches it is also possible to</span></span>
<span class="r-in"><span class="co">## filter matches keeping only the *best matches* using the</span></span>
<span class="r-in"><span class="co">## `TopRankedMatchesParam`. This will rank matches for each query based on</span></span>
<span class="r-in"><span class="co">## their *score* value and select the best *n* matches with lowest score</span></span>
<span class="r-in"><span class="co">## values (i.e. smallest difference in m/z values).</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">filterMatches</span><span class="op">(</span><span class="va">mo</span>, <span class="fu">TopRankedMatchesParam</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 5 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7     12       0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">########</span></span>
<span class="r-in"><span class="co">## Selecting the best match for each `query` element with `endoapply`</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## It is also possible to select for each `query` element the match with the</span></span>
<span class="r-in"><span class="co">## lowest score using `endoapply`. We manually define a function to select</span></span>
<span class="r-in"><span class="co">## the best match for each query and give it as input to `endoapply`</span></span>
<span class="r-in"><span class="co">## together with the `Matched` object itself. We obtain the same results as</span></span>
<span class="r-in"><span class="co">## in the `filterMatches` example above.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">FUN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">matches</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in">        <span class="va">x</span><span class="op">@</span><span class="va">matches</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">matches</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">matches</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span class="r-in">    <span class="va">x</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">endoapply</span><span class="op">(</span><span class="va">mo</span>, <span class="va">FUN</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as(from, to_class, strict = FALSE):</span> no method or default for coercing “list” to “Matched”</span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 5 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7     12       0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">########</span></span>
<span class="r-in"><span class="co">## Adding matches using `addMatches`</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## `addMatches` allows to manually add matches. Below we add a new match</span></span>
<span class="r-in"><span class="co">## between the `query` element with a value of `1` in column `"col1"` and</span></span>
<span class="r-in"><span class="co">## the target element with a value of `15`. Parameter `score` allows to</span></span>
<span class="r-in"><span class="co">## assign a score value to the match.</span></span>
<span class="r-in"><span class="va">mo_add</span> <span class="op">&lt;-</span> <span class="fu">addMatches</span><span class="op">(</span><span class="va">mo</span>, queryValue <span class="op">=</span> <span class="fl">1</span>, queryColname <span class="op">=</span> <span class="st">"col1"</span>,</span>
<span class="r-in">    targetValue <span class="op">=</span> <span class="fl">15</span>, score <span class="op">=</span> <span class="fl">1.40</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_add</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 8 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1         1         6     15       1.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2         7     12       0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1         2         7     13       0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2         2         7     14       0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5        10     15       0.9</span>
<span class="r-in"><span class="co">## Matches are always sorted by `query`, thus, the new match is listed as</span></span>
<span class="r-in"><span class="co">## second match.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Alternatively, we can also provide a `data.frame` with parameter `score`</span></span>
<span class="r-in"><span class="co">## which enables us to add additional information to the added match. Below</span></span>
<span class="r-in"><span class="co">## we define the score and an additional column specifying that this match</span></span>
<span class="r-in"><span class="co">## was added manually. This information will then also be available in the</span></span>
<span class="r-in"><span class="co">## `matchedData`.</span></span>
<span class="r-in"><span class="va">mo_add</span> <span class="op">&lt;-</span> <span class="fu">addMatches</span><span class="op">(</span><span class="va">mo</span>, queryValue <span class="op">=</span> <span class="fl">1</span>, queryColname <span class="op">=</span> <span class="st">"col1"</span>,</span>
<span class="r-in">    targetValue <span class="op">=</span> <span class="fl">15</span>, score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>score <span class="op">=</span> <span class="fl">5</span>, manual <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_add</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 8 rows and 5 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          col1      col2 target     score    manual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt; &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1         6     12       0.5        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1         1         6     15       5.0      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2         7     12       0.6        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1         2         7     13       0.7        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2         2         7     14       0.8        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3         8     NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4         9     NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5        10     15       0.9        NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The match will get a score of NA if we're not providing any score.</span></span>
<span class="r-in"><span class="va">mo_add</span> <span class="op">&lt;-</span> <span class="fu">addMatches</span><span class="op">(</span><span class="va">mo</span>, queryValue <span class="op">=</span> <span class="fl">1</span>, queryColname <span class="op">=</span> <span class="st">"col1"</span>,</span>
<span class="r-in">    targetValue <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">matchedData</span><span class="op">(</span><span class="va">mo_add</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 8 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          col1      col2 target     score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;integer&gt; &lt;AsIs&gt; &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1         6     12       0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1         1         6     15        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2         7     12       0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.1         2         7     13       0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.2         2         7     14       0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3         8     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4         9     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5        10     15       0.9</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Creating a `Matched` object with a `SummarizedExperiment` for `query` and</span></span>
<span class="r-in"><span class="co">## a `vector` for `target`. The matches are specified in the same way as</span></span>
<span class="r-in"><span class="co">## the example before.</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MatrixGenerics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: matrixStats</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘MatrixGenerics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colWeightedMeans, colWeightedMedians, colWeightedSds,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowWeightedSds, rowWeightedVars</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: GenomicRanges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: IRanges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: GenomeInfoDb</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Biobase</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to Bioconductor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Vignettes contain introductory material; view with</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘Biobase’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:MatrixGenerics’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowMedians</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     anyMissing, rowMedians</span>
<span class="r-in"><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span></span>
<span class="r-in">  assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  rowData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, col2 <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">  colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cD1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, cD2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">16</span>, col2 <span class="op">=</span> <span class="fl">17</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Define matches between row 1 in rowData(q1) with target row 2 and,</span></span>
<span class="r-in"><span class="co">## rowData(q1) row 2 with target rows 2,3,4 and rowData(q1) row 5 with target</span></span>
<span class="r-in"><span class="co">## row 5.</span></span>
<span class="r-in"><span class="va">mo</span> <span class="op">&lt;-</span> <span class="fu">Matched</span><span class="op">(</span></span>
<span class="r-in">    <span class="va">q1</span>, <span class="va">t1</span>, matches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>query_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span class="r-in">                                target_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">4L</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span class="r-in">                                 score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mo</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class Matched </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of matches: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of query objects: 5 (3 matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of target objects: 6 (4 matched)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which of the query elements (rows) match at least one target</span></span>
<span class="r-in"><span class="co">## element (row)?</span></span>
<span class="r-in"><span class="fu">whichQuery</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which target elements (rows) match at least one query element (row)?</span></span>
<span class="r-in"><span class="fu">whichTarget</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3 4 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting variable "col1" from rowData(q1).</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## We have duplicated values for the entries of `col1` related to rows of</span></span>
<span class="r-in"><span class="co">## rowData(q1) matched to multiple rows of the target data.frame t1. The</span></span>
<span class="r-in"><span class="co">## value of `col1` is returned for each row in the rowData of query.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting variable "col1" from target object. To access columns from</span></span>
<span class="r-in"><span class="co">## target we have to prefix the name of the column by `"target_"`.</span></span>
<span class="r-in"><span class="co">## Note that only values of `col1` for rows matching at least one row in</span></span>
<span class="r-in"><span class="co">## rowData of query are returned and an NA is reported for those without</span></span>
<span class="r-in"><span class="co">## matching target rows.</span></span>
<span class="r-in"><span class="va">mo</span><span class="op">$</span><span class="va">target_col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The 3rd and 4th query rows do not match any target row, thus `NA` is</span></span>
<span class="r-in"><span class="co">## returned.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## `matchedData` can be used to extract all (or selected) columns</span></span>
<span class="r-in"><span class="co">## from the object. Same as with `$`, a left join between the columns</span></span>
<span class="r-in"><span class="co">## from the query and the target is performed. Below we extract selected</span></span>
<span class="r-in"><span class="co">## columns from the object as a DataFrame.</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">matchedData</span><span class="op">(</span><span class="va">mo</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span>, <span class="st">"target_col1"</span>,</span>
<span class="r-in">                                  <span class="st">"target_col2"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 7 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        col1      col2 target_col1 target_col2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;integer&gt; &lt;integer&gt;   &lt;integer&gt;   &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1         6          12          18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7          12          18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7          13          19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2         7          14          20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3         8          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4         9          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5        10          15          21</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">target_col1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The example `Matched` object contains all rows in the</span></span>
<span class="r-in"><span class="co">## `rowData` of the `SummarizedExperiment` and all target rows. Below we</span></span>
<span class="r-in"><span class="co">## subset the object keeping only rows that are matched to at least one</span></span>
<span class="r-in"><span class="co">## target row.</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="va">mo</span><span class="op">[</span><span class="fu">whichQuery</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## mo_sub contains now a `SummarizedExperiment` with only 3 rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## while the original object contains a `SummarizedExperiment` with all 5</span></span>
<span class="r-in"><span class="co">## rows:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">query</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Both objects contain however still the full target object:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## With the `pruneTarget` we can however reduce also the target rows to</span></span>
<span class="r-in"><span class="co">## only those that match at least one in the `rowData` of query</span></span>
<span class="r-in"><span class="va">mo_sub</span> <span class="op">&lt;-</span> <span class="fu">pruneTarget</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu">target</span><span class="op">(</span><span class="va">mo_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Witting, Johannes Rainer, Andrea Vicini, Carolin Huber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

