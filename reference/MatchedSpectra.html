<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Representation of Spectra matches — MatchedSpectra • MetaboAnnotation</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Representation of Spectra matches — MatchedSpectra" />
<meta property="og:description" content="Matches between query and target spectra can be represented by the
MatchedSpectra object. Functions like the matchSpectra() function will
return this type of object. By default, all data accessors work as
left joins between the query and the target spectra, i.e. values are
returned for each query spectrum with eventual duplicated entries (values)
if the query spectrum matches more than one target spectrum." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboAnnotation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/MetaboAnnotation.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Representation of Spectra matches</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/master/R/MatchedSpectra.R'><code>R/MatchedSpectra.R</code></a></small>
    <div class="hidden name"><code>MatchedSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Matches between query and target spectra can be represented by the
<code>MatchedSpectra</code> object. Functions like the <code><a href='matchSpectra.html'>matchSpectra()</a></code> function will
return this type of object. By default, all data accessors work as
<em>left joins</em> between the <em>query</em> and the <em>target</em> spectra, i.e. values are
returned for each <em>query</em> spectrum with eventual duplicated entries (values)
if the query spectrum matches more than one target spectrum.</p>
    </div>

    <div class="ref-usage sourceCode"><pre><code>MatchedSpectra(
  query = Spectra(),
  target = Spectra(),
  matches = data.frame(query_idx = integer(), target_idx = integer(), score =
    numeric())
)

# S4 method for MatchedSpectra
spectraVariables(object)

# S4 method for MatchedSpectra
colnames(x)

# S4 method for MatchedSpectra
$(x, name)

# S4 method for MatchedSpectra
spectraData(object, columns = spectraVariables(object))

# S4 method for MatchedSpectra
matchedData(object, columns = spectraVariables(object), ...)

# S4 method for MatchedSpectra
addProcessing(object, FUN, ..., spectraVariables = character())

# S4 method for MatchedSpectra
plotSpectraMirror(x, xlab = "m/z", ylab = "intensity", main = "")</code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p><code>Spectra</code> with the query spectra.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p><code>Spectra</code> with the spectra against which <code>query</code> has been
matched.</p></td>
    </tr>
    <tr>
      <th>matches</th>
      <td><p><code>data.frame</code> with columns <code>"query_idx"</code> (<code>integer</code>),
<code>"target_idx"</code> (<code>integer</code>) and <code>"score"</code> (<code>numeric</code>) representing the
<em>n:m</em> mapping of elements between the <code>query</code> and the <code>target</code> <code>Spectra</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p><code>MatchedSpectra</code> object.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p><code>MatchedSpectra</code> object.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>for <code>$</code>: the name of the spectra variable to extract.</p></td>
    </tr>
    <tr>
      <th>columns</th>
      <td><p>for <code>spectraData</code>: <code>character</code> vector with spectra variable
names that should be extracted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for <code>addProcessing</code>: additional parameters for the function <code>FUN</code>.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>for <code>addProcessing</code>: function to be applied to the peak matrix
of each spectrum in <code>object</code>. See <code><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra()</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>spectraVariables</th>
      <td><p>for <code>addProcessing</code>: <code>character</code> with additional
spectra variables that should be passed along to the function defined
with <code>FUN</code>. See <code><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>for <code>plotSpectraMirror</code>: the label for the x-axis.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>for <code>plotSpectraMirror</code>: the label for the y-axis.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>for <code>plotSpectraMirror</code>: an optional title for each plot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>See individual method desciption above for details.</p>
    <h2 class="hasAnchor" id="creation-and-subsetting"><a class="anchor" href="#creation-and-subsetting"></a>Creation and subsetting</h2>

    


<p><code>MatchedSpectra</code> objects can be created with the <code>MatchedSpectra</code> function
providing the <code>query</code> and <code>target</code> <code>Spectra</code> as well as a <code>data.frame</code> with
the</p><ul>
<li><p><code>[</code> subset the <code>MatchedSpectra</code> selecting <code>query</code> spectra to keep with
parameter <code>i</code>. The <code>target</code> spectra will by default be returned as-is.</p></li>
<li><p><code>pruneTarget</code> <em>cleans</em> the <code>MatchedSpectra</code> object by removing non-matched
target spectra.</p></li>
</ul>

    <h2 class="hasAnchor" id="extracting-data"><a class="anchor" href="#extracting-data"></a>Extracting data</h2>

    

<ul>
<li><p><code>$</code> extracts a single spectra variable from the <code>MatchedSpectra</code> <code>x</code>. Use
<code>spectraVariables</code> to get all available spectra variables. Prefix
<code>"target_"</code> is used for spectra variables from the <em>target</em> <code>Spectra</code>. The
matching scores are available as <em>spectra variable</em> <code>"score"</code>.
Similar to a left join between the query and target spectra, this function
returns a value for each query spectrum with eventual duplicated values for
query spectra matching more than one target spectrum. If spectra variables
from the target spectra are extracted, an <code>NA</code> is reported for <em>query</em>
spectra that don't match any target spectra. See examples below for more
details.</p></li>
<li><p><code>length</code> returns the number of <strong>query</strong> spectra.</p></li>
<li><p><code>matchedData</code> same as <code>spectraData</code> below.</p></li>
<li><p><code>spectraData</code> returns spectra variables from the query and/or target
<code>Spectra</code> as a <code>DataFrame</code>. Parameter <code>columns</code> allows to define which
variables should be returned (defaults to
<code>columns = spectraVariables(object)</code>), spectra variable names of the target
spectra need to be prefixed with <code>target_</code> (e.g. <code>target_msLevel</code> to get
the MS level from target spectra). The score from the matching function is
returned as spectra variable <code>"score"</code>. Similar to <code>$</code>, this function
performs a <em>left join</em> of spectra variables from the <em>query</em> and <em>target</em>
spectra returning all values for all query spectra (eventually returning
duplicated elements for query spectra matching multiple target spectra)
and the values for the target spectra matched to the respective query
spectra. See help on <code>$</code> above or examples below for details.</p></li>
<li><p><code>spectraVariables</code> returns all available spectra variables in the <em>query</em>
and <em>target</em> spectra. The prefix <code>"target_"</code> is used to label spectra
variables of target spectra (e.g. the name of the spectra variable for the
MS level of target spectra is called <code>"target_msLevel"</code>).</p></li>
<li><p><code>target</code> returns the <em>target</em> <code>Spectra</code>.</p></li>
<li><p><code>query</code> returns the <em>query</em> <code>Spectra</code>.</p></li>
<li><p><code>whichTarget</code> returns an <code>integer</code> with the indices of the spectra in
<em>target</em> that match at least on spectrum in <em>query</em>.</p></li>
<li><p><code>whichQuery</code> returns an <code>integer</code> with the indices of the spectra in
<em>query</em> that match at least on spectrum in <em>target</em>.</p></li>
</ul>

    <h2 class="hasAnchor" id="data-manipulation-and-plotting"><a class="anchor" href="#data-manipulation-and-plotting"></a>Data manipulation and plotting</h2>

    

<ul>
<li><p><code>addProcessing</code>: add a processing step to both the <em>query</em> and <em>target</em>
<code>Spectra</code> in <code>object</code>. Additional parameters for <code>FUN</code> can be passed <em>via</em>
<code>...</code>. See <code>addProcessing</code> documentation in <code><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra()</a></code> for more
information.</p></li>
<li><p><code>plotSpectraMirror</code>: creates a mirror plot between the query and each
matching target spectrum. Can only be applied to a <code>MatchedSpectra</code> with a
single query spectrum.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='Matched.html'>Matched</a> for additional functions available for <code>MatchedSpectra</code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'>## Creating a dummy MatchedSpectra object.</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/RforMassSpectrometry/Spectra'>Spectra</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>df1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html'>DataFrame</a></span><span class='op'>(</span></span>
<span class='r-in'>    msLevel <span class='op'>=</span> <span class='fl'>2L</span>, rtime <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>,</span>
<span class='r-in'>    spectrum_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span>, <span class='st'>"c"</span>, <span class='st'>"d"</span>, <span class='st'>"e"</span>, <span class='st'>"f"</span>, <span class='st'>"g"</span>, <span class='st'>"h"</span>, <span class='st'>"i"</span>, <span class='st'>"j"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>df2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html'>DataFrame</a></span><span class='op'>(</span></span>
<span class='r-in'>    msLevel <span class='op'>=</span> <span class='fl'>2L</span>, rtime <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>20</span><span class='op'>)</span>,</span>
<span class='r-in'>    spectrum_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>, <span class='st'>"E"</span><span class='op'>)</span>, <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>sp1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra</a></span><span class='op'>(</span><span class='va'>df1</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>sp2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Spectra/man/Spectra.html'>Spectra</a></span><span class='op'>(</span><span class='va'>df2</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>## Define matches between query spectrum 1 with target spectra 2 and 5,</span></span>
<span class='r-in'><span class='co'>## query spectrum 2 with target spectrum 2 and query spectrum 4 with target</span></span>
<span class='r-in'><span class='co'>## spectra 8, 12 and 15.</span></span>
<span class='r-in'><span class='va'>ms</span> <span class='op'>&lt;-</span> <span class='fu'>MatchedSpectra</span><span class='op'>(</span></span>
<span class='r-in'>    <span class='va'>sp1</span>, <span class='va'>sp2</span>, matches <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>query_idx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>4L</span>, <span class='fl'>4L</span>, <span class='fl'>4L</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   target_idx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='fl'>2L</span>, <span class='fl'>5L</span>, <span class='fl'>2L</span>, <span class='fl'>8L</span>, <span class='fl'>12L</span>, <span class='fl'>15L</span><span class='op'>)</span>,</span>
<span class='r-in'>                                   score <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Which of the query spectra match at least one target spectrum?</span></span>
<span class='r-in'><span class='fu'><a href='Matched.html'>whichQuery</a></span><span class='op'>(</span><span class='va'>ms</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1 2 4</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extracting spectra variables: accessor methods for spectra variables act</span></span>
<span class='r-in'><span class='co'>## as "left joins", i.e. they return a value for each query spectrum, with</span></span>
<span class='r-in'><span class='co'>## eventually duplicated elements if one query spectrum matches more than</span></span>
<span class='r-in'><span class='co'>## one target spectrum.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Which target spectrum matches at least one query spectrum?</span></span>
<span class='r-in'><span class='fu'><a href='Matched.html'>whichTarget</a></span><span class='op'>(</span><span class='va'>ms</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1]  2  5  8 12 15</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extracting the retention times of the query spectra.</span></span>
<span class='r-in'><span class='va'>ms</span><span class='op'>$</span><span class='va'>rtime</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1]  1  1  2  3  4  4  4  5  6  7  8  9 10</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## We have duplicated retention times for query spectrum 1 (matches 2 target</span></span>
<span class='r-in'><span class='co'>## spectra) and 4 (matches 3 target spectra). The retention time is returned</span></span>
<span class='r-in'><span class='co'>## for each query spectrum.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extracting retention times of the target spectra. Note that only retention</span></span>
<span class='r-in'><span class='co'>## times for target spectra matching at least one query spectrum are returned</span></span>
<span class='r-in'><span class='co'>## and an NA is reported for query spectra without matching target spectrum.</span></span>
<span class='r-in'><span class='va'>ms</span><span class='op'>$</span><span class='va'>target_rtime</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1]  2  5  2 NA  8  2  5 NA NA NA NA NA NA</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## The first query spectrum matches target spectra 2 and 5, thus their</span></span>
<span class='r-in'><span class='co'>## retention times are returned as well as the retention time of the second</span></span>
<span class='r-in'><span class='co'>## target spectrum that matches also query spectrum 2. The 3rd query spectrum</span></span>
<span class='r-in'><span class='co'>## does match any target spectrum, thus `NA` is returned. Query spectrum 4</span></span>
<span class='r-in'><span class='co'>## matches target spectra 8, 12, and 15, thus the next reported retention</span></span>
<span class='r-in'><span class='co'>## times are those from these 3 target spectra. None of the remaining 6 query</span></span>
<span class='r-in'><span class='co'>## spectra matches any target spectra and thus `NA` is reported for each of</span></span>
<span class='r-in'><span class='co'>## them.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## `spectraData` can be used to extract all (or selected) spectra variables</span></span>
<span class='r-in'><span class='co'>## from the object. Same as with `$`, a left join between the specta</span></span>
<span class='r-in'><span class='co'>## variables from the query spectra and the target spectra is performed. The</span></span>
<span class='r-in'><span class='co'>## prefix `"target_"` is used to label the spectra variables from the target</span></span>
<span class='r-in'><span class='co'>## spectra. Below we extract selected spectra variables from the object.</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html'>spectraData</a></span><span class='op'>(</span><span class='va'>ms</span>, columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"rtime"</span>, <span class='st'>"spectrum_id"</span>,</span>
<span class='r-in'>    <span class='st'>"target_rtime"</span>, <span class='st'>"target_spectrum_id"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>res</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> DataFrame with 13 rows and 4 columns</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>         rtime spectrum_id target_rtime target_spectrum_id</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     &lt;integer&gt; &lt;character&gt;    &lt;integer&gt;        &lt;character&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1           1           a            2                  B</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2           1           a            5                  E</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3           2           b            2                  B</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4           3           c           NA                 NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5           4           d            8                  C</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ...       ...         ...          ...                ...</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 9           6           f           NA                 NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 10          7           g           NA                 NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11          8           h           NA                 NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 12          9           i           NA                 NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 13         10           j           NA                 NA</span>
<span class='r-in'><span class='va'>res</span><span class='op'>$</span><span class='va'>spectrum_id</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] "a" "a" "b" "c" "d" "d" "d" "e" "f" "g" "h" "i" "j"</span>
<span class='r-in'><span class='va'>res</span><span class='op'>$</span><span class='va'>target_spectrum_id</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1] "B" "E" "B" NA  "C" "B" "E" NA  NA  NA  NA  NA  NA </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Again, all values for query spectra are returned and for query spectra not</span></span>
<span class='r-in'><span class='co'>## matching any target spectrum NA is reported as value for the respecive</span></span>
<span class='r-in'><span class='co'>## variable.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## The example matched spectra object contains all query and all target</span></span>
<span class='r-in'><span class='co'>## spectra. Below we subset the object keeping only query spectra that are</span></span>
<span class='r-in'><span class='co'>## matched to at least one target spectrum.</span></span>
<span class='r-in'><span class='va'>ms_sub</span> <span class='op'>&lt;-</span> <span class='va'>ms</span><span class='op'>[</span><span class='fu'><a href='Matched.html'>whichQuery</a></span><span class='op'>(</span><span class='va'>ms</span><span class='op'>)</span><span class='op'>]</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## ms_sub contains now only 3 query spectra:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>query</a></span><span class='op'>(</span><span class='va'>ms_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 3</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## while the original object contains all 10 query spectra:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>query</a></span><span class='op'>(</span><span class='va'>ms</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 10</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Both object contain however still the full target `Spectra`:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>ms</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 200</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>ms_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 200</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## With the `pruneTarget` we can however reduce also the target spectra to</span></span>
<span class='r-in'><span class='co'>## only those that match at least one query spectrum</span></span>
<span class='r-in'><span class='va'>ms_sub</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Matched.html'>pruneTarget</a></span><span class='op'>(</span><span class='va'>ms_sub</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>ms_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 5</span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by RforMassSpectrometry Package Maintainer, Michael Witting, Johannes Rainer, Andrea Vicini.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


