<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Matches between query and target spectra can be represented by the
MatchedSpectra object. Functions like the matchSpectra() function will
return this type of object. By default, all data accessors work as
left joins between the query and the target spectra, i.e. values are
returned for each query spectrum with eventual duplicated entries (values)
if the query spectrum matches more than one target spectrum."><title>Representation of Spectra matches — MatchedSpectra • MetaboAnnotation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Representation of Spectra matches — MatchedSpectra"><meta property="og:description" content="Matches between query and target spectra can be represented by the
MatchedSpectra object. Functions like the matchSpectra() function will
return this type of object. By default, all data accessors work as
left joins between the query and the target spectra, i.e. values are
returned for each query spectrum with eventual duplicated entries (values)
if the query spectrum matches more than one target spectrum."><meta property="og:image" content="https://rformassspectrometry.github.io/MetaboAnnotation/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetaboAnnotation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MetaboAnnotation.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MetaboAnnotation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Representation of Spectra matches</h1>
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/HEAD/R/MatchedSpectra.R" class="external-link"><code>R/MatchedSpectra.R</code></a></small>
      <div class="d-none name"><code>MatchedSpectra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Matches between query and target spectra can be represented by the
<code>MatchedSpectra</code> object. Functions like the <code><a href="matchSpectra.html">matchSpectra()</a></code> function will
return this type of object. By default, all data accessors work as
<em>left joins</em> between the <em>query</em> and the <em>target</em> spectra, i.e. values are
returned for each <em>query</em> spectrum with eventual duplicated entries (values)
if the query spectrum matches more than one target spectrum.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>MatchedSpectra(
  query = Spectra(),
  target = Spectra(),
  matches = data.frame(query_idx = integer(), target_idx = integer(), score =
    numeric())
)

# S4 method for MatchedSpectra
spectraVariables(object)

# S4 method for MatchedSpectra
colnames(x)

# S4 method for MatchedSpectra
$(x, name)

# S4 method for MatchedSpectra
spectraData(object, columns = spectraVariables(object))

# S4 method for MatchedSpectra
matchedData(object, columns = spectraVariables(object), ...)

# S4 method for MatchedSpectra
addProcessing(object, FUN, ..., spectraVariables = character())

# S4 method for MatchedSpectra
plotSpectraMirror(x, xlab = "m/z", ylab = "intensity", main = "", ...)

# S4 method for MatchedSpectra,MsBackend
setBackend(object, backend, ...)</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>query</dt>
<dd><p><code>Spectra</code> with the query spectra.</p></dd>


<dt>target</dt>
<dd><p><code>Spectra</code> with the spectra against which <code>query</code> has been
matched.</p></dd>


<dt>matches</dt>
<dd><p><code>data.frame</code> with columns <code>"query_idx"</code> (<code>integer</code>),
<code>"target_idx"</code> (<code>integer</code>) and <code>"score"</code> (<code>numeric</code>) representing the
<em>n:m</em> mapping of elements between the <code>query</code> and the <code>target</code> <code>Spectra</code>.</p></dd>


<dt>object</dt>
<dd><p><code>MatchedSpectra</code> object.</p></dd>


<dt>x</dt>
<dd><p><code>MatchedSpectra</code> object.</p></dd>


<dt>name</dt>
<dd><p>for <code>$</code>: the name of the spectra variable to extract.</p></dd>


<dt>columns</dt>
<dd><p>for <code>spectraData</code>: <code>character</code> vector with spectra variable
names that should be extracted.</p></dd>


<dt>...</dt>
<dd><p>for <code>addProcessing</code>: additional parameters for the function <code>FUN</code>.
For <code>plotSpectraMirror</code>: additional parameters passed to the plotting
functions.</p></dd>


<dt>FUN</dt>
<dd><p>for <code>addProcessing</code>: function to be applied to the peak matrix
of each spectrum in <code>object</code>. See <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> for more details.</p></dd>


<dt>spectraVariables</dt>
<dd><p>for <code>addProcessing</code>: <code>character</code> with additional
spectra variables that should be passed along to the function defined
with <code>FUN</code>. See <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> for details.</p></dd>


<dt>xlab</dt>
<dd><p>for <code>plotSpectraMirror</code>: the label for the x-axis.</p></dd>


<dt>ylab</dt>
<dd><p>for <code>plotSpectraMirror</code>: the label for the y-axis.</p></dd>


<dt>main</dt>
<dd><p>for <code>plotSpectraMirror</code>: an optional title for each plot.</p></dd>


<dt>backend</dt>
<dd><p>for <code>setBackend</code>: instance of an object extending <a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html" class="external-link">MsBackend</a>.
See help for <code>setBackend</code> in <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>See individual method desciption above for details.</p>
    </div>
    <div class="section level2">
    <h2 id="creation-and-subsetting">Creation and subsetting<a class="anchor" aria-label="anchor" href="#creation-and-subsetting"></a></h2>
    


<p><code>MatchedSpectra</code> objects can be created with the <code>MatchedSpectra</code> function
providing the <code>query</code> and <code>target</code> <code>Spectra</code> as well as a <code>data.frame</code> with
the</p><ul><li><p><code>[</code> subset the <code>MatchedSpectra</code> selecting <code>query</code> spectra to keep with
parameter <code>i</code>. The <code>target</code> spectra will by default be returned as-is.</p></li>
<li><p><code>pruneTarget</code> <em>cleans</em> the <code>MatchedSpectra</code> object by removing non-matched
target spectra.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="extracting-data">Extracting data<a class="anchor" aria-label="anchor" href="#extracting-data"></a></h2>
    

<ul><li><p><code>$</code> extracts a single spectra variable from the <code>MatchedSpectra</code> <code>x</code>. Use
<code>spectraVariables</code> to get all available spectra variables. Prefix
<code>"target_"</code> is used for spectra variables from the <em>target</em> <code>Spectra</code>. The
matching scores are available as <em>spectra variable</em> <code>"score"</code>.
Similar to a left join between the query and target spectra, this function
returns a value for each query spectrum with eventual duplicated values for
query spectra matching more than one target spectrum. If spectra variables
from the target spectra are extracted, an <code>NA</code> is reported for <em>query</em>
spectra that don't match any target spectra. See examples below for more
details.</p></li>
<li><p><code>length</code> returns the number of <strong>query</strong> spectra.</p></li>
<li><p><code>matchedData</code> same as <code>spectraData</code> below.</p></li>
<li><p><code>spectraData</code> returns spectra variables from the query and/or target
<code>Spectra</code> as a <code>DataFrame</code>. Parameter <code>columns</code> allows to define which
variables should be returned (defaults to
<code>columns = spectraVariables(object)</code>), spectra variable names of the target
spectra need to be prefixed with <code>target_</code> (e.g. <code>target_msLevel</code> to get
the MS level from target spectra). The score from the matching function is
returned as spectra variable <code>"score"</code>. Similar to <code>$</code>, this function
performs a <em>left join</em> of spectra variables from the <em>query</em> and <em>target</em>
spectra returning all values for all query spectra (eventually returning
duplicated elements for query spectra matching multiple target spectra)
and the values for the target spectra matched to the respective query
spectra. See help on <code>$</code> above or examples below for details.</p></li>
<li><p><code>spectraVariables</code> returns all available spectra variables in the <em>query</em>
and <em>target</em> spectra. The prefix <code>"target_"</code> is used to label spectra
variables of target spectra (e.g. the name of the spectra variable for the
MS level of target spectra is called <code>"target_msLevel"</code>).</p></li>
<li><p><code>target</code> returns the <em>target</em> <code>Spectra</code>.</p></li>
<li><p><code>query</code> returns the <em>query</em> <code>Spectra</code>.</p></li>
<li><p><code>whichTarget</code> returns an <code>integer</code> with the indices of the spectra in
<em>target</em> that match at least on spectrum in <em>query</em>.</p></li>
<li><p><code>whichQuery</code> returns an <code>integer</code> with the indices of the spectra in
<em>query</em> that match at least on spectrum in <em>target</em>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="data-manipulation-and-plotting">Data manipulation and plotting<a class="anchor" aria-label="anchor" href="#data-manipulation-and-plotting"></a></h2>
    

<ul><li><p><code>addProcessing</code>: add a processing step to both the <em>query</em> and <em>target</em>
<code>Spectra</code> in <code>object</code>. Additional parameters for <code>FUN</code> can be passed <em>via</em>
<code>...</code>. See <code>addProcessing</code> documentation in <code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> for more
information.</p></li>
<li><p><code>plotSpectraMirror</code>: creates a mirror plot between the query and each
matching target spectrum. Can only be applied to a <code>MatchedSpectra</code> with a
single query spectrum. Additional plotting parameters can be passed through
<code>...</code>.</p></li>
<li><p><code>setBackend</code>: allows to change the <em>backend</em> of both the query and target
<code><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra()</a></code> object. The function will return a <code>MatchedSpectra</code> object with
the query and target <code>Spectra</code> changed to the specified <code>backend</code>, which
can be any backend extending <a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html" class="external-link">MsBackend</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Matched.html">Matched()</a></code> for additional functions available for <code>MatchedSpectra</code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Johannes Rainer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Creating a dummy MatchedSpectra object.</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Spectra" class="external-link">Spectra</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span></span>
<span class="r-in">    msLevel <span class="op">=</span> <span class="fl">2L</span>, rtime <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span class="r-in">    spectrum_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"h"</span>, <span class="st">"i"</span>, <span class="st">"j"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span></span>
<span class="r-in">    msLevel <span class="op">=</span> <span class="fl">2L</span>, rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span class="r-in">    spectrum_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Define matches between query spectrum 1 with target spectra 2 and 5,</span></span>
<span class="r-in"><span class="co">## query spectrum 2 with target spectrum 2 and query spectrum 4 with target</span></span>
<span class="r-in"><span class="co">## spectra 8, 12 and 15.</span></span>
<span class="r-in"><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu">MatchedSpectra</span><span class="op">(</span></span>
<span class="r-in">    <span class="va">sp1</span>, <span class="va">sp2</span>, matches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>query_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">4L</span>, <span class="fl">4L</span>, <span class="fl">4L</span><span class="op">)</span>,</span>
<span class="r-in">                                   target_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">5L</span>, <span class="fl">2L</span>, <span class="fl">8L</span>, <span class="fl">12L</span>, <span class="fl">15L</span><span class="op">)</span>,</span>
<span class="r-in">                                   score <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which of the query spectra match at least one target spectrum?</span></span>
<span class="r-in"><span class="fu"><a href="Matched.html">whichQuery</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 4</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting spectra variables: accessor methods for spectra variables act</span></span>
<span class="r-in"><span class="co">## as "left joins", i.e. they return a value for each query spectrum, with</span></span>
<span class="r-in"><span class="co">## eventually duplicated elements if one query spectrum matches more than</span></span>
<span class="r-in"><span class="co">## one target spectrum.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Which target spectrum matches at least one query spectrum?</span></span>
<span class="r-in"><span class="fu"><a href="Matched.html">whichTarget</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2  5  8 12 15</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting the retention times of the query spectra.</span></span>
<span class="r-in"><span class="va">ms</span><span class="op">$</span><span class="va">rtime</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  1  2  3  4  4  4  5  6  7  8  9 10</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## We have duplicated retention times for query spectrum 1 (matches 2 target</span></span>
<span class="r-in"><span class="co">## spectra) and 4 (matches 3 target spectra). The retention time is returned</span></span>
<span class="r-in"><span class="co">## for each query spectrum.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Extracting retention times of the target spectra. Note that only retention</span></span>
<span class="r-in"><span class="co">## times for target spectra matching at least one query spectrum are returned</span></span>
<span class="r-in"><span class="co">## and an NA is reported for query spectra without matching target spectrum.</span></span>
<span class="r-in"><span class="va">ms</span><span class="op">$</span><span class="va">target_rtime</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2  5  2 NA  8  2  5 NA NA NA NA NA NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The first query spectrum matches target spectra 2 and 5, thus their</span></span>
<span class="r-in"><span class="co">## retention times are returned as well as the retention time of the second</span></span>
<span class="r-in"><span class="co">## target spectrum that matches also query spectrum 2. The 3rd query spectrum</span></span>
<span class="r-in"><span class="co">## does match any target spectrum, thus `NA` is returned. Query spectrum 4</span></span>
<span class="r-in"><span class="co">## matches target spectra 8, 12, and 15, thus the next reported retention</span></span>
<span class="r-in"><span class="co">## times are those from these 3 target spectra. None of the remaining 6 query</span></span>
<span class="r-in"><span class="co">## spectra matches any target spectra and thus `NA` is reported for each of</span></span>
<span class="r-in"><span class="co">## them.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## `spectraData` can be used to extract all (or selected) spectra variables</span></span>
<span class="r-in"><span class="co">## from the object. Same as with `$`, a left join between the specta</span></span>
<span class="r-in"><span class="co">## variables from the query spectra and the target spectra is performed. The</span></span>
<span class="r-in"><span class="co">## prefix `"target_"` is used to label the spectra variables from the target</span></span>
<span class="r-in"><span class="co">## spectra. Below we extract selected spectra variables from the object.</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectraData</a></span><span class="op">(</span><span class="va">ms</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rtime"</span>, <span class="st">"spectrum_id"</span>,</span>
<span class="r-in">    <span class="st">"target_rtime"</span>, <span class="st">"target_spectrum_id"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 13 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rtime spectrum_id target_rtime target_spectrum_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;integer&gt; &lt;character&gt;    &lt;integer&gt;        &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1           a            2                  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1           a            5                  E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           2           b            2                  B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           3           c           NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           4           d            8                  C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...       ...         ...          ...                ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           6           f           NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          7           g           NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          8           h           NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12          9           i           NA                 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         10           j           NA                 NA</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">spectrum_id</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "a" "a" "b" "c" "d" "d" "d" "e" "f" "g" "h" "i" "j"</span>
<span class="r-in"><span class="va">res</span><span class="op">$</span><span class="va">target_spectrum_id</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "B" "E" "B" NA  "C" "B" "E" NA  NA  NA  NA  NA  NA </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Again, all values for query spectra are returned and for query spectra not</span></span>
<span class="r-in"><span class="co">## matching any target spectrum NA is reported as value for the respecive</span></span>
<span class="r-in"><span class="co">## variable.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The example matched spectra object contains all query and all target</span></span>
<span class="r-in"><span class="co">## spectra. Below we subset the object keeping only query spectra that are</span></span>
<span class="r-in"><span class="co">## matched to at least one target spectrum.</span></span>
<span class="r-in"><span class="va">ms_sub</span> <span class="op">&lt;-</span> <span class="va">ms</span><span class="op">[</span><span class="fu"><a href="Matched.html">whichQuery</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## ms_sub contains now only 3 query spectra:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="Matched.html">query</a></span><span class="op">(</span><span class="va">ms_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## while the original object contains all 10 query spectra:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="Matched.html">query</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Both object contain however still the full target `Spectra`:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="Matched.html">target</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 200</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="Matched.html">target</a></span><span class="op">(</span><span class="va">ms_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 200</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## With the `pruneTarget` we can however reduce also the target spectra to</span></span>
<span class="r-in"><span class="co">## only those that match at least one query spectrum</span></span>
<span class="r-in"><span class="va">ms_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="Matched.html">pruneTarget</a></span><span class="op">(</span><span class="va">ms_sub</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="Matched.html">target</a></span><span class="op">(</span><span class="va">ms_sub</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Witting, Johannes Rainer, Andrea Vicini, Carolin Huber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

