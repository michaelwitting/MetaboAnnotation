<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Representation of SummarizedExperiment matches — MatchedSummarizedExperiment • MetaboAnnotation</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Representation of SummarizedExperiment matches — MatchedSummarizedExperiment" />
<meta property="og:description" content="Matches between a query SummarizedExperiment and target data.frame can be
represented by theMatchedSummarizedExperiment object. Functions like the
matchMz() function can return this type of object.
By default, all data accessors work as left joins between the query
SummarizedExperiment and the target data.frame, i.e. values are
returned for each row in rowData of query  with eventual duplicated
entries (values) if such row matches more than one target row." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboAnnotation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/MetaboAnnotation.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/MetaboAnnotation/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Representation of SummarizedExperiment matches</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/MetaboAnnotation/blob/master/R/MatchedSummarizedExperiment.R'><code>R/MatchedSummarizedExperiment.R</code></a></small>
    <div class="hidden name"><code>MatchedSummarizedExperiment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Matches between a query <code>SummarizedExperiment</code> and target <code>data.frame</code> can be
represented by the<code>MatchedSummarizedExperiment</code> object. Functions like the
<code><a href='matchMz.html'>matchMz()</a></code> function can return this type of object.
By default, all data accessors work as <em>left joins</em> between the <em>query</em>
<code>SummarizedExperiment</code> and the <em>target</em> <code>data.frame</code>, i.e. values are
returned for each row in <code>rowData</code> of <em>query</em>  with eventual duplicated
entries (values) if such row matches more than one target row.</p>
    </div>

    <div class="ref-usage sourceCode"><pre><code>MatchedSummarizedExperiment(
  query = SummarizedExperiment(),
  target = data.frame(),
  matches = data.frame(query_idx = integer(), target_idx = integer(), score =
    numeric())
)

# S4 method for MatchedSummarizedExperiment
colnames(x)

# S4 method for MatchedSummarizedExperiment
$(x, name)

# S4 method for MatchedSummarizedExperiment
matchedData(object, columns = colnames(object), ...)</code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query</th>
      <td><p><code>SummarizedExperiment</code> object having as <code>rowData</code> a <code>DFrame</code>
with rows to be matched to those in <code>target</code></p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p><code>data.frame</code> with the elements against which <code>query</code> has been
matched.</p></td>
    </tr>
    <tr>
      <th>matches</th>
      <td><p><code>data.frame</code> with columns <code>"query_idx"</code> (<code>integer</code>),
<code>"target_idx"</code> (<code>integer</code>) and <code>"score"</code> (<code>numeric</code>) representing the n:m
mapping between the rows of <code>rowData</code> of query<code>and the</code>target` rows.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p><code>MatchedSummarizedExperiment</code> object.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>for <code>$</code>: the name of the column (or variable) to extract.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>a <code>MatchedSummarizedExperiment</code> object.</p></td>
    </tr>
    <tr>
      <th>columns</th>
      <td><p>for <code>matchedData</code>: <code>character</code> vector with column names of
variables that should be extracted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>See individual method description above for details.</p>
    <h2 class="hasAnchor" id="creation-and-subsetting"><a class="anchor" href="#creation-and-subsetting"></a>Creation and subsetting</h2>

    


<p><code>MatchedSummarizedExperiment</code> objects can be created with the
<code>MatchedSummarizedExperiment</code> function providing the <code>query</code>
<code>SummarizedExperiment</code> and <code>target</code> <code>data.frame</code> as well as a <code>data.frame</code>
with two columns of integer indices defining which elements from <code>rowData</code>
of <em>query</em> match which element from <em>target</em>.</p><ul>
<li><p><code>[</code> subsets the rows to keep (specified throught parameter <code>i</code>) in
<code>rowData</code> of <code>query</code> . The <code>target</code> <code>data.frame</code> will by default be
returned as-is.</p></li>
<li><p><code>pruneTarget</code> <em>cleans</em> the <code>MatchedSummarizedExperiment</code> object by removing
non-matched rows in target <code>data.frame</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="extracting-data"><a class="anchor" href="#extracting-data"></a>Extracting data</h2>

    

<ul>
<li><p><code>$</code> extracts a single variable from the <code>MatchedSummarizedExperiment</code> <code>x</code>.
The variables that can be extracted can be listed using <code>colnames(x)</code>.
These variables can belong to <code>rowData</code> of <em>query</em>, <em>target</em> or be related
to the matches (e.g. the score of each match available as <em>variable</em>
<code>"score"</code>). Prefix<code> "target_"</code> is used for columns in the <em>target</em> object.
Similar to a left join between the query <code>rowData</code> rows and target rows,
this function returns a value for each query row, with eventual
duplicated values for query rows matching more than one target element.
If variables from the target <code>data.frame</code> are extracted, an <code>NA</code> is
reported for the entries corresponding to <em>query</em> <code>rowData</code> rows that don't
match any target row See examples below for more details.</p></li>
<li><p><code>length</code> returns the number of rows in <strong>query</strong> <code>rowData</code>.</p></li>
<li><p><code>matchedData</code> allows to extract multiple variables contained in the
<code>MatchedSummarizedExperiment</code> object as a <code>DataFrame</code>. Parameter <code>columns</code>
allows to define which columns (or variables) should be returned (defaults
to <code>columns = colnames(object)</code>). Each single column in the returned
<code>DataFrame</code> is constructed in the same way as in <code>$</code>. That is, like <code>$</code>,
this function performs a <em>left join</em> of variables from the <em>query</em> and
<em>target</em> objects returning all values for rows in query <code>rowData</code>
(eventually returning duplicated elements for query elements matching
multiple targetelements) and the values for the target elements matched to
the respective query elements (or <code>NA</code> if the target element is not matched
to any query element).</p></li>
<li><p><code>target</code> returns the <em>target</em> <code>data.frame</code>.</p></li>
<li><p><code>query</code> returns the <em>query</em> <code>SummarizedExperiment</code>.</p></li>
<li><p><code>whichTarget</code> returns an <code>integer</code> with the indices of the rows in
<em>target</em> that match at least one row in <code>rowData</code> of <em>query</em>.</p></li>
<li><p><code>whichQuery</code> returns an <code>integer</code> with the indices of the rows in <code>rowData</code>
of <em>query</em> that match at least one row in <em>target</em>.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Andrea Vicini, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'>## Creating a MatchedSummarizedExperiment object.</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/SummarizedExperiment'>SummarizedExperiment</a></span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: MatrixGenerics</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: matrixStats</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Attaching package: ‘MatrixGenerics’</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colWeightedMeans, colWeightedMedians, colWeightedSds,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians,</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowWeightedSds, rowWeightedVars</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: GenomicRanges</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: IRanges</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: GenomeInfoDb</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: Biobase</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Welcome to Bioconductor</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     Vignettes contain introductory material; view with</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     'browseVignettes()'. To cite Bioconductor, see</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Attaching package: ‘Biobase’</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following object is masked from ‘package:MatrixGenerics’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     rowMedians</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     anyMissing, rowMedians</span>
<span class='r-in'><span class='va'>q1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment</a></span><span class='op'>(</span></span>
<span class='r-in'>  assays <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>5</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span class='r-in'>  rowData <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>col1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, col2 <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>,</span>
<span class='r-in'>  colData <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>cD1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>, cD2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>t1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>col1 <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>16</span>, col2 <span class='op'>=</span> <span class='fl'>17</span><span class='op'>:</span><span class='fl'>22</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>## Define matches between row 1 in rowData(q1) with target row 2 and, </span></span>
<span class='r-in'><span class='co'>## rowData(q1) row 2 with target rows 2,3,4 and rowData(q1) row 5 with target </span></span>
<span class='r-in'><span class='co'>## row 5.</span></span>
<span class='r-in'><span class='va'>mo</span> <span class='op'>&lt;-</span> <span class='fu'>MatchedSummarizedExperiment</span><span class='op'>(</span></span>
<span class='r-in'>    <span class='va'>q1</span>, <span class='va'>t1</span>, matches <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>query_idx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>5L</span><span class='op'>)</span>,</span>
<span class='r-in'>                                target_idx <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>3L</span>, <span class='fl'>4L</span>, <span class='fl'>5L</span><span class='op'>)</span>,</span>
<span class='r-in'>                                 score <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.9</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>mo</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Object of class MatchedSummarizedExperiment </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Total number of matches: 5 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of query objects: 5 (3 matched)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Number of target objects: 6 (4 matched)</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Which of the query elements (rows) match at least one target</span></span>
<span class='r-in'><span class='co'>## element (row)?</span></span>
<span class='r-in'><span class='fu'><a href='Matched.html'>whichQuery</a></span><span class='op'>(</span><span class='va'>mo</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1 2 5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Which target elements (rows) match at least one query element (row)?</span></span>
<span class='r-in'><span class='fu'><a href='Matched.html'>whichTarget</a></span><span class='op'>(</span><span class='va'>mo</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 2 3 4 5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extracting variable "col1" from rowData(q1).</span></span>
<span class='r-in'><span class='va'>mo</span><span class='op'>$</span><span class='va'>col1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## We have duplicated values for the entries of `col1` related to rows of </span></span>
<span class='r-in'><span class='co'>## rowData(q1) matched to multiple rows of the target data.frame t1. The</span></span>
<span class='r-in'><span class='co'>## value of `col1` is returned for each row in the rowData of query.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Extracting variable "col1" from target object. To access columns from</span></span>
<span class='r-in'><span class='co'>## target we have to prefix the name of the column by `"target_"`.</span></span>
<span class='r-in'><span class='co'>## Note that only values of `col1` for rows matching at least one row in </span></span>
<span class='r-in'><span class='co'>## rowData of query are returned and an NA is reported for those without </span></span>
<span class='r-in'><span class='co'>## matching target rows.</span></span>
<span class='r-in'><span class='va'>mo</span><span class='op'>$</span><span class='va'>target_col1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## The 3rd and 4th query rows do not match any target row, thus `NA` is</span></span>
<span class='r-in'><span class='co'>## returned.</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## `matchedData` can be used to extract all (or selected) columns</span></span>
<span class='r-in'><span class='co'>## from the object. Same as with `$`, a left join between the columns</span></span>
<span class='r-in'><span class='co'>## from the query and the target is performed. Below we extract selected</span></span>
<span class='r-in'><span class='co'>## columns from the object as a DataFrame.</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Matched.html'>matchedData</a></span><span class='op'>(</span><span class='va'>mo</span>, columns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/S4Vectors/man/Vector-class.html'>c</a></span><span class='op'>(</span><span class='st'>"col1"</span>, <span class='st'>"col2"</span>, <span class='st'>"target_col1"</span>, <span class='st'>"target_col2"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>res</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> DataFrame with 7 rows and 4 columns</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>        col1      col2 target_col1 target_col2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   &lt;integer&gt; &lt;integer&gt;   &lt;integer&gt;   &lt;integer&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1         1         6          12          18</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2         2         7          12          18</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2         2         7          13          19</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2         2         7          14          20</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3         3         8          NA          NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4         4         9          NA          NA</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5         5        10          15          21</span>
<span class='r-in'><span class='va'>res</span><span class='op'>$</span><span class='va'>col1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1 2 2 2 3 4 5</span>
<span class='r-in'><span class='va'>res</span><span class='op'>$</span><span class='va'>target_col1</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 12 12 13 14 NA NA 15</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## The example MatchedSummarizedExperiment object contains all rows in the </span></span>
<span class='r-in'><span class='co'>## rowData of the SummarizedExperiment and all target rows. Below we subset the </span></span>
<span class='r-in'><span class='co'>## object keeping only rows that are matched to at least one target row.</span></span>
<span class='r-in'><span class='va'>mo_sub</span> <span class='op'>&lt;-</span> <span class='va'>mo</span><span class='op'>[</span><span class='fu'><a href='Matched.html'>whichQuery</a></span><span class='op'>(</span><span class='va'>mo</span><span class='op'>)</span><span class='op'>]</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## mo_sub contains now a SummarizedExperiment with only 3 rows:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>query</a></span><span class='op'>(</span><span class='va'>mo_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 3</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## while the original object contains a SummarizedExperiment with all 5 rows:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>query</a></span><span class='op'>(</span><span class='va'>mo</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 5</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## Both objects contain however still the full target object:</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>mo</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 6</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>mo_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 6</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>## With the `pruneTarget` we can however reduce also the target rows to</span></span>
<span class='r-in'><span class='co'>## only those that match at least one in the rowData of query</span></span>
<span class='r-in'><span class='va'>mo_sub</span> <span class='op'>&lt;-</span> <span class='fu'><a href='Matched.html'>pruneTarget</a></span><span class='op'>(</span><span class='va'>mo_sub</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='Matched.html'>target</a></span><span class='op'>(</span><span class='va'>mo_sub</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 4</span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by RforMassSpectrometry Package Maintainer, Michael Witting, Johannes Rainer, Andrea Vicini.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


